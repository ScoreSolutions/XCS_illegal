<?xml version="1.0" encoding="UTF-8"?>
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="ILLR8114" language="groovy" pageWidth="842" pageHeight="595" orientation="Landscape" columnWidth="802" leftMargin="20" rightMargin="20" topMargin="20" bottomMargin="20">
	<property name="ireport.zoom" value="2.0"/>
	<property name="ireport.x" value="844"/>
	<property name="ireport.y" value="212"/>
	<parameter name="getMonthfrom" class="java.lang.String"/>
	<parameter name="getMonthto" class="java.lang.String"/>
	<parameter name="getYear1" class="java.lang.String"/>
	<parameter name="getUserID" class="java.lang.String">
		<defaultValueExpression><![CDATA["100"]]></defaultValueExpression>
	</parameter>
	<queryString>
		<![CDATA[select cc.offcode,
cc.short_name,
cc.offname,
cc.month_name,
  to_char(sysdate, 'fmdd month yyyy', 'NLS_CALENDAR=''THAI BUDDHA'' NLS_DATE_LANGUAGE=THAI') untildate,
to_char(sysdate, 'hh24:mi', 'NLS_CALENDAR=''THAI BUDDHA'' NLS_DATE_LANGUAGE=THAI') systimedate,
        (select ti.title_name || st.first_name || ' ' || st.last_name staff_name
                          from staff st
                          left join title ti on ti.title_code=st.title_code
                          where st.idcard_no=$P{getUserID}) user_name,
cc.case_qty compare_case_qty,
cc.sendcourt_qty,
cc.no_culprit_qty,
cc.total_case_qty,
cc.target_qty,
cc.diff_case_qty,
cc.diff_case_percent,
cc.compare_fine,
cc.sendcourt_fine,
cc.no_culprit_fine,
cc.total_sum_fine,
cc.target_fine,
cc.diff_fine,
cc.diff_fine_percent
from (
select a.offcode,a.short_name, a.offname, a.month_name,
a.case_qty, a.sendcourt_qty,a.no_culprit_qty,
a.case_qty+ a.sendcourt_qty+a.no_culprit_qty total_case_qty,
a.target_qty,
(a.case_qty+ a.sendcourt_qty+a.no_culprit_qty)-nvl(a.target_qty,0) diff_case_qty,
case nvl(a.target_qty,0) when 0 then 100
else
    (((a.case_qty+a.sendcourt_qty+a.no_culprit_qty)-nvl(a.target_qty,0))*100)/a.target_qty
end diff_case_percent,
a.compare_fine,
a.sendcourt_fine,
a.no_culprit_fine,
a.compare_fine+ a.sendcourt_fine+ a.no_culprit_fine total_sum_fine,
a.target_fine, (a.compare_fine+ a.sendcourt_fine+ a.no_culprit_fine)-nvl(a.target_fine,0) diff_fine,
case  nvl(a.target_fine,0) when 0 then 100
else
    (((a.compare_fine+ a.sendcourt_fine+ a.no_culprit_fine)-nvl(a.target_fine,0))*100)/a.target_fine
end diff_fine_percent
from (
    select ed.offcode, ed.short_name, ed.offname,
    to_char(to_date($P{getMonthfrom},'yyyy-mm-dd'), 'month', 'NLS_CALENDAR=''THAI BUDDHA'' NLS_DATE_LANGUAGE=THAI') as month_name,
    pke_reports.getAllCaseQty(ed.offcode,to_date($P{getMonthfrom},'yyyy-mm-dd'), to_date($P{getMonthto},'yyyy-mm-dd'),'2') case_qty,
    pke_reports.getAllCompareQty(ed.offcode, to_date($P{getMonthfrom},'yyyy-mm-dd'), to_date($P{getMonthto},'yyyy-mm-dd'),'2') compare_case_qty,
    pke_reports.getAllSendCourtQty(ed.offcode, to_date($P{getMonthfrom},'yyyy-mm-dd'), to_date($P{getMonthto},'yyyy-mm-dd'),'2','2') sendcourt_qty,
    pke_reports.getAllNoCulpritQty(ed.offcode, to_date($P{getMonthfrom},'yyyy-mm-dd'), to_date($P{getMonthto},'yyyy-mm-dd'),'2') no_culprit_qty,
    pke_reports.getAllCompareFine(ed.offcode, to_date($P{getMonthfrom},'yyyy-mm-dd'), to_date($P{getMonthto},'yyyy-mm-dd'),'2') compare_fine,
    pke_reports.getAllSendCourtFine(ed.offcode, to_date($P{getMonthfrom},'yyyy-mm-dd'), to_date($P{getMonthto},'yyyy-mm-dd'),'2','2') sendcourt_fine,
    pke_reports.getAllNoCulpritFine(ed.offcode, to_date($P{getMonthfrom},'yyyy-mm-dd'), to_date($P{getMonthto},'yyyy-mm-dd'),'2') no_culprit_fine,
    tg.target_qty,tg.target_fine
    from ed_office ed
    left join (select st.offcode, sum(sti.qty_10+sti.qty_11+sti.qty_12+sti.qty_01+sti.qty_02+sti.qty_03+sti.qty_04+sti.qty_05+sti.qty_06+sti.qty_07+sti.qty_08+sti.qty_09) target_qty,
                  sum(sti.fine_10+sti.fine_11+sti.fine_12+sti.fine_01+sti.fine_02+sti.fine_03+sti.fine_04+sti.fine_05+sti.fine_06+sti.fine_07+sti.fine_08+sti.fine_09) target_fine
                  from suppress_target st
                  inner join suppress_target_item sti on sti.suppress_target_id=st.id
                  where sti.target_type='1' and st.status='0' and st.budget_year=$P{getYear1}
                  group by st.offcode) tg on tg.offcode=ed.offcode
    where substr(ed.offcode,3,4)='0000' and substr(ed.offcode,1,2)<>'00'
    order by ed.offcode
) a
union all
select '','รวม', '',a.month_name,
sum(a.case_qty),
sum(a.sendcourt_qty),
sum(a.no_culprit_qty),
sum(a.case_qty+ a.sendcourt_qty+a.no_culprit_qty) total_case_qty,
sum(a.target_qty),
sum((a.case_qty+ a.sendcourt_qty+a.no_culprit_qty)-nvl(a.target_qty,0)) diff_case_qty,
sum(case nvl(a.target_qty,0) when 0 then 100
else
    (((a.case_qty+a.sendcourt_qty+a.no_culprit_qty)-nvl(a.target_qty,0))*100)/a.target_qty
end) diff_case_percent,
sum(a.compare_fine),
sum(a.sendcourt_fine),
sum(a.no_culprit_fine),
sum(a.compare_fine+ a.sendcourt_fine+ a.no_culprit_fine) total_sum_fine,
sum(a.target_fine),
sum((a.compare_fine+ a.sendcourt_fine+ a.no_culprit_fine)-nvl(a.target_fine,0)) diff_fine,
sum(case  nvl(a.target_fine,0) when 0 then 100
else
    (((a.compare_fine+ a.sendcourt_fine+ a.no_culprit_fine)-nvl(a.target_fine,0))*100)/a.target_fine
end) diff_fine_percent
from (
    select ed.offcode, ed.short_name, ed.offname,
    to_char(to_date($P{getMonthfrom},'yyyy-mm-dd'), 'month', 'NLS_CALENDAR=''THAI BUDDHA'' NLS_DATE_LANGUAGE=THAI') as month_name,
    pke_reports.getAllCaseQty(ed.offcode, to_date($P{getMonthfrom},'yyyy-mm-dd'), to_date($P{getMonthto},'yyyy-mm-dd'),'2') case_qty,
    pke_reports.getAllCompareQty(ed.offcode, to_date($P{getMonthfrom},'yyyy-mm-dd'), to_date($P{getMonthto},'yyyy-mm-dd'),'2') compare_case_qty,
    pke_reports.getAllSendCourtQty(ed.offcode, to_date($P{getMonthfrom},'yyyy-mm-dd'), to_date($P{getMonthto},'yyyy-mm-dd'),'2','2') sendcourt_qty,
    pke_reports.getAllNoCulpritQty(ed.offcode, to_date($P{getMonthfrom},'yyyy-mm-dd'), to_date($P{getMonthto},'yyyy-mm-dd'),'2') no_culprit_qty,
    pke_reports.getAllCompareFine(ed.offcode, to_date($P{getMonthfrom},'yyyy-mm-dd'), to_date($P{getMonthto},'yyyy-mm-dd'),'2') compare_fine,
    pke_reports.getAllSendCourtFine(ed.offcode, to_date($P{getMonthfrom},'yyyy-mm-dd'), to_date($P{getMonthto},'yyyy-mm-dd'),'2','2') sendcourt_fine,
    pke_reports.getAllNoCulpritFine(ed.offcode, to_date($P{getMonthfrom},'yyyy-mm-dd'), to_date($P{getMonthto},'yyyy-mm-dd'),'2') no_culprit_fine,
    tg.target_qty,tg.target_fine
    from ed_office ed
    left join (select st.offcode, sum(sti.qty_10+sti.qty_11+sti.qty_12+sti.qty_01+sti.qty_02+sti.qty_03+sti.qty_04+sti.qty_05+sti.qty_06+sti.qty_07+sti.qty_08+sti.qty_09) target_qty,
                  sum(sti.fine_10+sti.fine_11+sti.fine_12+sti.fine_01+sti.fine_02+sti.fine_03+sti.fine_04+sti.fine_05+sti.fine_06+sti.fine_07+sti.fine_08+sti.fine_09) target_fine
                  from suppress_target st
                  inner join suppress_target_item sti on sti.suppress_target_id=st.id
                  where sti.target_type='1' and st.status='0' and st.budget_year=$P{getYear1}
                  group by st.offcode) tg on tg.offcode=ed.offcode
    where substr(ed.offcode,3,4)='0000' and substr(ed.offcode,1,2)<>'00'
) a
union all
select '','เดือนเดียวกันของปีก่อน', '',a.month_name,
sum(a.case_qty),
sum(a.sendcourt_qty),
sum(a.no_culprit_qty),
sum(a.case_qty+ a.sendcourt_qty+a.no_culprit_qty) total_case_qty,
sum(a.target_qty),
sum((a.case_qty+ a.sendcourt_qty+a.no_culprit_qty)-nvl(a.target_qty,0)) diff_case_qty,
sum(case nvl(a.target_qty,0) when 0 then 100
else
    (((a.case_qty+a.sendcourt_qty+a.no_culprit_qty)-nvl(a.target_qty,0))*100)/a.target_qty
end) diff_case_percent,
sum(a.compare_fine), sum(a.sendcourt_fine), sum(a.no_culprit_fine), sum(a.compare_fine+ a.sendcourt_fine+ a.no_culprit_fine) total_sum_fine,
sum(a.target_fine), sum((a.compare_fine+ a.sendcourt_fine+ a.no_culprit_fine)-nvl(a.target_fine,0)) diff_fine,
sum(case  nvl(a.target_fine,0) when 0 then 100
else
    (((a.compare_fine+ a.sendcourt_fine+ a.no_culprit_fine)-nvl(a.target_fine,0))*100)/a.target_fine
end) diff_fine_percent
from (
    select ed.offcode, ed.short_name, ed.offname,
    to_char(to_date($P{getMonthfrom},'yyyy-mm-dd'), 'month', 'NLS_CALENDAR=''THAI BUDDHA'' NLS_DATE_LANGUAGE=THAI') as month_name,
    pke_reports.getAllCaseQty(ed.offcode, add_months(to_date($P{getMonthfrom},'yyyy-mm-dd'),-12),add_months(to_date($P{getMonthto},'yyyy-mm-dd'), -12),'2') case_qty,
    pke_reports.getAllCompareQty(ed.offcode, add_months(to_date($P{getMonthfrom},'yyyy-mm-dd'),-12),add_months(to_date($P{getMonthto},'yyyy-mm-dd'), -12),'2') compare_case_qty,
    pke_reports.getAllSendCourtQty(ed.offcode, add_months(to_date($P{getMonthfrom},'yyyy-mm-dd'),-12),add_months(to_date($P{getMonthto},'yyyy-mm-dd'), -12),'2','2') sendcourt_qty,
    pke_reports.getAllNoCulpritQty(ed.offcode, add_months(to_date($P{getMonthfrom},'yyyy-mm-dd'),-12),add_months(to_date($P{getMonthto},'yyyy-mm-dd'), -12),'2') no_culprit_qty,
    pke_reports.getAllCompareFine(ed.offcode, add_months(to_date($P{getMonthfrom},'yyyy-mm-dd'),-12),add_months(to_date($P{getMonthto},'yyyy-mm-dd'), -12),'2') compare_fine,
    pke_reports.getAllSendCourtFine(ed.offcode, add_months(to_date($P{getMonthfrom},'yyyy-mm-dd'),-12),add_months(to_date($P{getMonthto},'yyyy-mm-dd'), -12),'2','2') sendcourt_fine,
    pke_reports.getAllNoCulpritFine(ed.offcode, add_months(to_date($P{getMonthfrom},'yyyy-mm-dd'),-12),add_months(to_date($P{getMonthto},'yyyy-mm-dd'), -12),'2') no_culprit_fine,
    tg.target_qty,tg.target_fine
    from ed_office ed
    left join (select st.offcode, sum(sti.qty_10+sti.qty_11+sti.qty_12+sti.qty_01+sti.qty_02+sti.qty_03+sti.qty_04+sti.qty_05+sti.qty_06+sti.qty_07+sti.qty_08+sti.qty_09) target_qty,
                  sum(sti.fine_10+sti.fine_11+sti.fine_12+sti.fine_01+sti.fine_02+sti.fine_03+sti.fine_04+sti.fine_05+sti.fine_06+sti.fine_07+sti.fine_08+sti.fine_09) target_fine
                  from suppress_target st
                  inner join suppress_target_item sti on sti.suppress_target_id=st.id
                  where sti.target_type='1' and st.status='0' and st.budget_year=$P{getYear1}
                  group by st.offcode) tg on tg.offcode=ed.offcode
    where substr(ed.offcode,3,4)='0000' and substr(ed.offcode,1,2)<>'00'
) a
union all
select '','ผลต่าง + สูง - ต่ำ', '',aa.month_name,
(aa.case_qty-bb.case_qty) as compare_case_qty,
(aa.sendcourt_qty-bb.sendcourt_qty) as sendcourt_qty,
(aa.no_culprit_qty-bb.no_culprit_qty ) as no_culprit_qty,
(aa.total_case_qty-bb.total_case_qty ) as total_case_qty,
(aa.target_qty-bb.target_qty ) as target_qty,
(aa.diff_case_qty-bb.diff_case_qty) as diff_case_qty,
(aa.diff_case_percent-bb.diff_case_percent) as diff_case_percent,
(aa.compare_fine-bb.compare_fine)as compare_fine,
(aa.sendcourt_fine-bb.sendcourt_fine) as sendcourt_fine,
(aa.no_culprit_fine-bb.no_culprit_fine ) as no_culprit_fine,
(aa.total_sum_fine-bb.total_sum_fine)as total_sum_fine,
(aa.target_fine-bb.target_fine) as target_fine,
(aa.diff_fine-bb.diff_fine) as diff_fine,
(aa.diff_fine_percent-bb.diff_fine_percent) as diff_fine_percent

from (
select 1 as id ,a.month_name,
sum(a.case_qty) as case_qty ,
sum(a.sendcourt_qty) as sendcourt_qty,
sum(a.no_culprit_qty) as no_culprit_qty,
sum(a.case_qty+ a.sendcourt_qty+a.no_culprit_qty) as total_case_qty,
sum(a.target_qty) as target_qty,
sum((a.case_qty+ a.sendcourt_qty+a.no_culprit_qty)-nvl(a.target_qty,0)) as diff_case_qty,
sum(case nvl(a.target_qty,0) when 0 then 100
else
    (((a.case_qty+a.sendcourt_qty+a.no_culprit_qty)-nvl(a.target_qty,0))*100)/a.target_qty
end) as diff_case_percent,
sum(a.compare_fine) as compare_fine,
sum(a.sendcourt_fine) as sendcourt_fine,
sum(a.no_culprit_fine) as no_culprit_fine,
sum(a.compare_fine+ a.sendcourt_fine+ a.no_culprit_fine) as total_sum_fine,
sum(a.target_fine)as target_fine,
sum((a.compare_fine+ a.sendcourt_fine+ a.no_culprit_fine)-nvl(a.target_fine,0)) as diff_fine,
sum(case  nvl(a.target_fine,0) when 0 then 100
else
    (((a.compare_fine+ a.sendcourt_fine+ a.no_culprit_fine)-nvl(a.target_fine,0))*100)/a.target_fine
end) as diff_fine_percent
from (
    select ed.offcode, ed.short_name, ed.offname,
    to_char(to_date($P{getMonthfrom},'yyyy-mm-dd'), 'month', 'NLS_CALENDAR=''THAI BUDDHA'' NLS_DATE_LANGUAGE=THAI') as month_name,
    pke_reports.getAllCaseQty(ed.offcode, to_date($P{getMonthfrom},'yyyy-mm-dd'), to_date($P{getMonthto},'yyyy-mm-dd'),'2') case_qty,
    pke_reports.getAllCompareQty(ed.offcode, to_date($P{getMonthfrom},'yyyy-mm-dd'), to_date($P{getMonthto},'yyyy-mm-dd'),'2') compare_case_qty,
    pke_reports.getAllSendCourtQty(ed.offcode, to_date($P{getMonthfrom},'yyyy-mm-dd'), to_date($P{getMonthto},'yyyy-mm-dd'),'2','2') sendcourt_qty,
    pke_reports.getAllNoCulpritQty(ed.offcode, to_date($P{getMonthfrom},'yyyy-mm-dd'), to_date($P{getMonthto},'yyyy-mm-dd'),'2') no_culprit_qty,
    pke_reports.getAllCompareFine(ed.offcode, to_date($P{getMonthfrom},'yyyy-mm-dd'), to_date($P{getMonthto},'yyyy-mm-dd'),'2') compare_fine,
    pke_reports.getAllSendCourtFine(ed.offcode, to_date($P{getMonthfrom},'yyyy-mm-dd'), to_date($P{getMonthto},'yyyy-mm-dd'),'2','2') sendcourt_fine,
    pke_reports.getAllNoCulpritFine(ed.offcode, to_date($P{getMonthfrom},'yyyy-mm-dd'), to_date($P{getMonthto},'yyyy-mm-dd'),'2') no_culprit_fine,
    tg.target_qty,tg.target_fine
    from ed_office ed
    left join (select st.offcode, sum(sti.qty_10+sti.qty_11+sti.qty_12+sti.qty_01+sti.qty_02+sti.qty_03+sti.qty_04+sti.qty_05+sti.qty_06+sti.qty_07+sti.qty_08+sti.qty_09) target_qty,
                  sum(sti.fine_10+sti.fine_11+sti.fine_12+sti.fine_01+sti.fine_02+sti.fine_03+sti.fine_04+sti.fine_05+sti.fine_06+sti.fine_07+sti.fine_08+sti.fine_09) target_fine
                  from suppress_target st
                  inner join suppress_target_item sti on sti.suppress_target_id=st.id
                  where sti.target_type='1' and st.status='0' and st.budget_year=$P{getYear1}
                  group by st.offcode) tg on tg.offcode=ed.offcode
    where substr(ed.offcode,3,4)='0000' and substr(ed.offcode,1,2)<>'00'
    ) a
 ) aa
  inner join (
  select 1 as id ,sum(a.case_qty)as case_qty,
sum(a.sendcourt_qty)as sendcourt_qty,sum(a.no_culprit_qty) as no_culprit_qty,
sum(a.case_qty+ a.sendcourt_qty+a.no_culprit_qty) total_case_qty,
sum(a.target_qty) as target_qty,
sum((a.case_qty+ a.sendcourt_qty+a.no_culprit_qty)-nvl(a.target_qty,0)) diff_case_qty,
sum(case nvl(a.target_qty,0) when 0 then 100
else
    (((a.case_qty+a.sendcourt_qty+a.no_culprit_qty)-nvl(a.target_qty,0))*100)/a.target_qty
end) diff_case_percent,
sum(a.compare_fine) as compare_fine,
sum(a.sendcourt_fine) as sendcourt_fine,
sum(a.no_culprit_fine) as no_culprit_fine,
sum(a.compare_fine+ a.sendcourt_fine+ a.no_culprit_fine) total_sum_fine,
sum(a.target_fine) as target_fine,
sum((a.compare_fine+ a.sendcourt_fine+ a.no_culprit_fine)-nvl(a.target_fine,0)) diff_fine,
sum(case  nvl(a.target_fine,0) when 0 then 100
else
    (((a.compare_fine+ a.sendcourt_fine+ a.no_culprit_fine)-nvl(a.target_fine,0))*100)/a.target_fine
end) diff_fine_percent
from (
    select ed.offcode, ed.short_name, ed.offname,
    to_char(to_date($P{getMonthfrom},'yyyy-mm-dd'), 'month', 'NLS_CALENDAR=''THAI BUDDHA'' NLS_DATE_LANGUAGE=THAI') as month_name,
    pke_reports.getAllCaseQty(ed.offcode, add_months(to_date($P{getMonthfrom},'yyyy-mm-dd'),-12),add_months(to_date($P{getMonthto},'yyyy-mm-dd'), -12),'2') case_qty,
    pke_reports.getAllCompareQty(ed.offcode, add_months(to_date($P{getMonthfrom},'yyyy-mm-dd'),-12),add_months(to_date($P{getMonthto},'yyyy-mm-dd'), -12),'2') compare_case_qty,
    pke_reports.getAllSendCourtQty(ed.offcode, add_months(to_date($P{getMonthfrom},'yyyy-mm-dd'),-12),add_months(to_date($P{getMonthto},'yyyy-mm-dd'), -12),'2','2') sendcourt_qty,
    pke_reports.getAllNoCulpritQty(ed.offcode, add_months(to_date($P{getMonthfrom},'yyyy-mm-dd'),-12),add_months(to_date($P{getMonthto},'yyyy-mm-dd'), -12),'2') no_culprit_qty,
    pke_reports.getAllCompareFine(ed.offcode, add_months(to_date($P{getMonthfrom},'yyyy-mm-dd'),-12),add_months(to_date($P{getMonthto},'yyyy-mm-dd'), -12),'2') compare_fine,
    pke_reports.getAllSendCourtFine(ed.offcode, add_months(to_date($P{getMonthfrom},'yyyy-mm-dd'),-12),add_months(to_date($P{getMonthto},'yyyy-mm-dd'), -12),'2','2') sendcourt_fine,
    pke_reports.getAllNoCulpritFine(ed.offcode, add_months(to_date($P{getMonthfrom},'yyyy-mm-dd'),-12),add_months(to_date($P{getMonthto},'yyyy-mm-dd'), -12),'2') no_culprit_fine,
    tg.target_qty,tg.target_fine
    from ed_office ed
    left join (select st.offcode, sum(sti.qty_10+sti.qty_11+sti.qty_12+sti.qty_01+sti.qty_02+sti.qty_03+sti.qty_04+sti.qty_05+sti.qty_06+sti.qty_07+sti.qty_08+sti.qty_09) target_qty,
                  sum(sti.fine_10+sti.fine_11+sti.fine_12+sti.fine_01+sti.fine_02+sti.fine_03+sti.fine_04+sti.fine_05+sti.fine_06+sti.fine_07+sti.fine_08+sti.fine_09) target_fine
                  from suppress_target st
                  inner join suppress_target_item sti on sti.suppress_target_id=st.id
                  where sti.target_type='1' and st.status='0' and st.budget_year=$P{getYear1}
                  group by st.offcode) tg on tg.offcode=ed.offcode
    where substr(ed.offcode,3,4)='0000' and substr(ed.offcode,1,2)<>'00'
) a
) bb
 on aa.id = bb.id
union all
select '','คิดเป็น %', '',aa.month_name,
(((aa.case_qty-bb.case_qty)*100)/case when aa.case_qty is null or aa.case_qty = 0 then 1 else aa.case_qty end ) as case_qty,
(((aa.sendcourt_qty-bb.sendcourt_qty)*100)/case when aa.sendcourt_qty is null or aa.sendcourt_qty = 0 then 1 else aa.sendcourt_qty end) as sendcourt_qty,
(((aa.no_culprit_qty-bb.no_culprit_qty)*100)/case when aa.no_culprit_qty is null or aa.no_culprit_qty = 0 then 1 else aa.no_culprit_qty end) as no_culprit_qty,
(((aa.total_case_qty-bb.total_case_qty )*100)/case when aa.total_case_qty is null or aa.total_case_qty = 0 then 1 else aa.total_case_qty end) as total_case_qty,
(((aa.target_qty-bb.target_qty )*100)/case when aa.target_qty is null or aa.target_qty = 0 then 1 else aa.target_qty end) as target_qty,
(((aa.diff_case_qty-bb.diff_case_qty)*100)/case when aa.diff_case_qty is null or aa.diff_case_qty = 0 then 1 else aa.diff_case_qty end) as diff_case_qty,
(((aa.diff_case_percent-bb.diff_case_percent)*100)/case when aa.diff_case_percent is null or aa.diff_case_percent = 0 then 1 else aa.diff_case_percent end) as diff_case_percent,
(((aa.compare_fine-bb.compare_fine)*100)/case when aa.compare_fine is null or aa.compare_fine = 0 then 1 else aa.compare_fine end) as compare_fine,
(((aa.sendcourt_fine-bb.sendcourt_fine)*100)/case when aa.sendcourt_fine is null or aa.sendcourt_fine = 0 then 1 else aa.sendcourt_fine end) as sendcourt_fine,
(((aa.no_culprit_fine-bb.no_culprit_fine)*100)/case when aa.no_culprit_fine is null or aa.no_culprit_fine = 0 then 1 else aa.no_culprit_fine end) as no_culprit_fine,
(((aa.total_sum_fine-bb.total_sum_fine)*100)/case when aa.total_sum_fine is null or aa.total_sum_fine = 0 then 1 else aa.total_sum_fine end) as total_sum_fine,
(((aa.target_fine-bb.target_fine)*100)/case when aa.target_fine is null or aa.target_fine = 0 then 1 else aa.target_fine end) as target_fine,
(((aa.diff_fine-bb.diff_fine)*100)/case when aa.diff_fine is null or aa.diff_fine = 0 then 1 else aa.diff_fine end) as diff_fine,
(((aa.diff_fine_percent-bb.diff_fine_percent)*100)/case when aa.diff_fine_percent is null or aa.diff_fine_percent = 0 then 1 else aa.diff_fine_percent end) as diff_fine_percent

from (
select 1 as id ,a.month_name,
sum(a.case_qty) as case_qty ,
sum(a.sendcourt_qty) as sendcourt_qty,
sum(a.no_culprit_qty) as no_culprit_qty,
sum(a.case_qty+ a.sendcourt_qty+a.no_culprit_qty) as total_case_qty,
sum(a.target_qty) as target_qty,
sum((a.case_qty+ a.sendcourt_qty+a.no_culprit_qty)-nvl(a.target_qty,0)) as diff_case_qty,
sum(case nvl(a.target_qty,0) when 0 then 100
else
    (((a.case_qty+a.sendcourt_qty+a.no_culprit_qty)-nvl(a.target_qty,0))*100)/a.target_qty
end) as diff_case_percent,
sum(a.compare_fine) as compare_fine,
sum(a.sendcourt_fine) as sendcourt_fine,
sum(a.no_culprit_fine) as no_culprit_fine,
sum(a.compare_fine+ a.sendcourt_fine+ a.no_culprit_fine) as total_sum_fine,
sum(a.target_fine)as target_fine,
sum((a.compare_fine+ a.sendcourt_fine+ a.no_culprit_fine)-nvl(a.target_fine,0)) as diff_fine,
sum(case  nvl(a.target_fine,0) when 0 then 100
else
    (((a.compare_fine+ a.sendcourt_fine+ a.no_culprit_fine)-nvl(a.target_fine,0))*100)/a.target_fine
end) as diff_fine_percent
from (
    select ed.offcode, ed.short_name, ed.offname,
    to_char(to_date($P{getMonthfrom},'yyyy-mm-dd'), 'month', 'NLS_CALENDAR=''THAI BUDDHA'' NLS_DATE_LANGUAGE=THAI') as month_name,
    pke_reports.getAllCaseQty(ed.offcode, to_date($P{getMonthfrom},'yyyy-mm-dd'), to_date($P{getMonthto},'yyyy-mm-dd'),'2') case_qty,
    pke_reports.getAllCompareQty(ed.offcode, to_date($P{getMonthfrom},'yyyy-mm-dd'), to_date($P{getMonthto},'yyyy-mm-dd'),'2') compare_case_qty,
    pke_reports.getAllSendCourtQty(ed.offcode, to_date($P{getMonthfrom},'yyyy-mm-dd'), to_date($P{getMonthto},'yyyy-mm-dd'),'2','2') sendcourt_qty,
    pke_reports.getAllNoCulpritQty(ed.offcode, to_date($P{getMonthfrom},'yyyy-mm-dd'), to_date($P{getMonthto},'yyyy-mm-dd'),'2') no_culprit_qty,
    pke_reports.getAllCompareFine(ed.offcode, to_date($P{getMonthfrom},'yyyy-mm-dd'), to_date($P{getMonthto},'yyyy-mm-dd'),'2') compare_fine,
    pke_reports.getAllSendCourtFine(ed.offcode, to_date($P{getMonthfrom},'yyyy-mm-dd'), to_date($P{getMonthto},'yyyy-mm-dd'),'2','2') sendcourt_fine,
    pke_reports.getAllNoCulpritFine(ed.offcode, to_date($P{getMonthfrom},'yyyy-mm-dd'), to_date($P{getMonthto},'yyyy-mm-dd'),'2') no_culprit_fine,
    tg.target_qty,tg.target_fine
    from ed_office ed
    left join (select st.offcode, sum(sti.qty_10+sti.qty_11+sti.qty_12+sti.qty_01+sti.qty_02+sti.qty_03+sti.qty_04+sti.qty_05+sti.qty_06+sti.qty_07+sti.qty_08+sti.qty_09) target_qty,
                  sum(sti.fine_10+sti.fine_11+sti.fine_12+sti.fine_01+sti.fine_02+sti.fine_03+sti.fine_04+sti.fine_05+sti.fine_06+sti.fine_07+sti.fine_08+sti.fine_09) target_fine
                  from suppress_target st
                  inner join suppress_target_item sti on sti.suppress_target_id=st.id
                  where sti.target_type='1' and st.status='0' and st.budget_year=$P{getYear1}
                  group by st.offcode) tg on tg.offcode=ed.offcode
    where substr(ed.offcode,3,4)='0000' and substr(ed.offcode,1,2)<>'00'
    ) a
 ) aa
  inner join (
  select 1 as id ,sum(a.case_qty)as case_qty,
sum(a.sendcourt_qty)as sendcourt_qty,
sum(a.no_culprit_qty) as no_culprit_qty,
sum(a.case_qty+ a.sendcourt_qty+a.no_culprit_qty) total_case_qty,
sum(a.target_qty) as target_qty,
sum((a.case_qty+ a.sendcourt_qty+a.no_culprit_qty)-nvl(a.target_qty,0)) diff_case_qty,
sum(case nvl(a.target_qty,0) when 0 then 100
else
    (((a.case_qty+a.sendcourt_qty+a.no_culprit_qty)-nvl(a.target_qty,0))*100)/a.target_qty
end) diff_case_percent,
sum(a.compare_fine) as compare_fine,
sum(a.sendcourt_fine) as sendcourt_fine,
sum(a.no_culprit_fine) as no_culprit_fine,
sum(a.compare_fine+ a.sendcourt_fine+ a.no_culprit_fine) total_sum_fine,
sum(a.target_fine) as target_fine,
sum((a.compare_fine+ a.sendcourt_fine+ a.no_culprit_fine)-nvl(a.target_fine,0)) diff_fine,
sum(case  nvl(a.target_fine,0) when 0 then 100
else
    (((a.compare_fine+ a.sendcourt_fine+ a.no_culprit_fine)-nvl(a.target_fine,0))*100)/a.target_fine
end) diff_fine_percent
from (
    select ed.offcode, ed.short_name, ed.offname,
    to_char(to_date($P{getMonthfrom},'yyyy-mm-dd'), 'month', 'NLS_CALENDAR=''THAI BUDDHA'' NLS_DATE_LANGUAGE=THAI') as month_name,
    pke_reports.getAllCaseQty(ed.offcode, add_months(to_date($P{getMonthfrom},'yyyy-mm-dd'),-12),add_months(to_date($P{getMonthto},'yyyy-mm-dd'), -12),'2') case_qty,
    pke_reports.getAllCompareQty(ed.offcode, add_months(to_date($P{getMonthfrom},'yyyy-mm-dd'),-12),add_months(to_date($P{getMonthto},'yyyy-mm-dd'), -12),'2') compare_case_qty,
    pke_reports.getAllSendCourtQty(ed.offcode, add_months(to_date($P{getMonthfrom},'yyyy-mm-dd'),-12),add_months(to_date($P{getMonthto},'yyyy-mm-dd'), -12),'2','2') sendcourt_qty,
    pke_reports.getAllNoCulpritQty(ed.offcode, add_months(to_date($P{getMonthfrom},'yyyy-mm-dd'),-12),add_months(to_date($P{getMonthto},'yyyy-mm-dd'), -12),'2') no_culprit_qty,
    pke_reports.getAllCompareFine(ed.offcode, add_months(to_date($P{getMonthfrom},'yyyy-mm-dd'),-12),add_months(to_date($P{getMonthto},'yyyy-mm-dd'), -12),'2') compare_fine,
    pke_reports.getAllSendCourtFine(ed.offcode, add_months(to_date($P{getMonthfrom},'yyyy-mm-dd'),-12),add_months(to_date($P{getMonthto},'yyyy-mm-dd'), -12),'2','2') sendcourt_fine,
    pke_reports.getAllNoCulpritFine(ed.offcode, add_months(to_date($P{getMonthfrom},'yyyy-mm-dd'),-12),add_months(to_date($P{getMonthto},'yyyy-mm-dd'), -12),'2') no_culprit_fine,
    tg.target_qty,tg.target_fine
    from ed_office ed
    left join (select st.offcode, sum(sti.qty_10+sti.qty_11+sti.qty_12+sti.qty_01+sti.qty_02+sti.qty_03+sti.qty_04+sti.qty_05+sti.qty_06+sti.qty_07+sti.qty_08+sti.qty_09) target_qty,
                  sum(sti.fine_10+sti.fine_11+sti.fine_12+sti.fine_01+sti.fine_02+sti.fine_03+sti.fine_04+sti.fine_05+sti.fine_06+sti.fine_07+sti.fine_08+sti.fine_09) target_fine
                  from suppress_target st
                  inner join suppress_target_item sti on sti.suppress_target_id=st.id
                  where sti.target_type='1' and st.status='0' and st.budget_year=$P{getYear1}
                  group by st.offcode) tg on tg.offcode=ed.offcode
    where substr(ed.offcode,3,4)='0000' and substr(ed.offcode,1,2)<>'00'
) a
) bb
 on aa.id = bb.id
) cc]]>
	</queryString>
	<field name="OFFCODE" class="java.lang.String"/>
	<field name="SHORT_NAME" class="java.lang.String"/>
	<field name="OFFNAME" class="java.lang.String"/>
	<field name="MONTH_NAME" class="java.lang.String"/>
	<field name="UNTILDATE" class="java.lang.String"/>
	<field name="SYSTIMEDATE" class="java.lang.String"/>
	<field name="USER_NAME" class="java.lang.String"/>
	<field name="COMPARE_CASE_QTY" class="java.math.BigDecimal"/>
	<field name="SENDCOURT_QTY" class="java.math.BigDecimal"/>
	<field name="NO_CULPRIT_QTY" class="java.math.BigDecimal"/>
	<field name="TOTAL_CASE_QTY" class="java.math.BigDecimal"/>
	<field name="TARGET_QTY" class="java.math.BigDecimal"/>
	<field name="DIFF_CASE_QTY" class="java.math.BigDecimal"/>
	<field name="DIFF_CASE_PERCENT" class="java.math.BigDecimal"/>
	<field name="COMPARE_FINE" class="java.math.BigDecimal"/>
	<field name="SENDCOURT_FINE" class="java.math.BigDecimal"/>
	<field name="NO_CULPRIT_FINE" class="java.math.BigDecimal"/>
	<field name="TOTAL_SUM_FINE" class="java.math.BigDecimal"/>
	<field name="TARGET_FINE" class="java.math.BigDecimal"/>
	<field name="DIFF_FINE" class="java.math.BigDecimal"/>
	<field name="DIFF_FINE_PERCENT" class="java.math.BigDecimal"/>
	<variable name="DIFF_PERCENT" class="java.lang.String"/>
	<group name="8114_Group">
		<groupHeader>
			<band height="123">
				<rectangle>
					<reportElement x="0" y="0" width="802" height="123" backcolor="#BFBFBF"/>
				</rectangle>
				<line>
					<reportElement x="319" y="0" width="1" height="123"/>
				</line>
				<line>
					<reportElement x="125" y="0" width="1" height="123"/>
				</line>
				<line>
					<reportElement x="360" y="0" width="1" height="123"/>
				</line>
				<line>
					<reportElement x="443" y="0" width="1" height="123"/>
				</line>
				<line>
					<reportElement x="652" y="0" width="1" height="123"/>
				</line>
				<line>
					<reportElement x="704" y="0" width="1" height="123"/>
				</line>
				<staticText>
					<reportElement x="-11" y="0" width="147" height="123"/>
					<textElement textAlignment="Center" verticalAlignment="Middle" markup="none">
						<font fontName="Angsana New" size="16" pdfFontName="ANGSA.TTF" pdfEncoding="Identity-H" isPdfEmbedded="true"/>
					</textElement>
					<text><![CDATA[หน่วยงาน]]></text>
				</staticText>
				<staticText>
					<reportElement x="126" y="0" width="204" height="52"/>
					<textElement textAlignment="Center" verticalAlignment="Middle" markup="none">
						<font fontName="Angsana New" size="14" pdfFontName="ANGSA.TTF" pdfEncoding="Identity-H" isPdfEmbedded="true"/>
					</textElement>
					<text><![CDATA[ผลการปฏิบัติงาน(คดี)]]></text>
				</staticText>
				<line>
					<reportElement x="174" y="52" width="1" height="71"/>
				</line>
				<line>
					<reportElement x="222" y="52" width="1" height="71"/>
				</line>
				<line>
					<reportElement x="269" y="52" width="1" height="71"/>
				</line>
				<staticText>
					<reportElement x="115" y="52" width="69" height="71"/>
					<textElement textAlignment="Center" verticalAlignment="Middle">
						<font fontName="AngsanaUPC" size="14" pdfFontName="ANGSA.TTF" pdfEncoding="Identity-H" isPdfEmbedded="true"/>
					</textElement>
					<text><![CDATA[(1)
เปรียบเทียบ
ปรับ]]></text>
				</staticText>
				<staticText>
					<reportElement x="166" y="52" width="67" height="71"/>
					<textElement textAlignment="Center" verticalAlignment="Middle">
						<font fontName="AngsanaUPC" size="14" pdfFontName="ANGSA.TTF" pdfEncoding="Identity-H" isPdfEmbedded="true"/>
					</textElement>
					<text><![CDATA[(2)
ฟ้องศาล]]></text>
				</staticText>
				<staticText>
					<reportElement x="211" y="52" width="69" height="71"/>
					<textElement textAlignment="Center" verticalAlignment="Middle">
						<font fontName="AngsanaUPC" size="14" pdfFontName="ANGSA.TTF" pdfEncoding="Identity-H" isPdfEmbedded="true"/>
					</textElement>
					<text><![CDATA[(3)
ไม่มีตัว
ผู้กระทำผิด]]></text>
				</staticText>
				<staticText>
					<reportElement x="259" y="52" width="71" height="71"/>
					<textElement textAlignment="Center" verticalAlignment="Middle">
						<font fontName="AngsanaUPC" size="14" pdfFontName="ANGSA.TTF" pdfEncoding="Identity-H" isPdfEmbedded="true"/>
					</textElement>
					<text><![CDATA[ (4)
รวม
(1)+(2)+(3)]]></text>
				</staticText>
				<staticText>
					<reportElement x="300" y="0" width="80" height="123"/>
					<textElement textAlignment="Center" verticalAlignment="Middle">
						<font fontName="AngsanaUPC" size="14" pdfFontName="ANGSA.TTF" pdfEncoding="Identity-H" isPdfEmbedded="true"/>
					</textElement>
					<text><![CDATA[(5)
เป้าหมาย
คดี]]></text>
				</staticText>
				<staticText>
					<reportElement x="349" y="0" width="64" height="123"/>
					<textElement textAlignment="Center" verticalAlignment="Middle">
						<font fontName="AngsanaUPC" size="14" pdfFontName="ANGSA.TTF" pdfEncoding="Identity-H" isPdfEmbedded="true"/>
					</textElement>
					<text><![CDATA[ผลต่าง(4)
กับ(5)
 +สูง - ต่ำ]]></text>
				</staticText>
				<staticText>
					<reportElement x="422" y="0" width="221" height="52"/>
					<textElement textAlignment="Center" verticalAlignment="Middle">
						<font fontName="AngsanaUPC" size="14" pdfFontName="ANGSA.TTF" pdfEncoding="Identity-H" isPdfEmbedded="true"/>
					</textElement>
					<text><![CDATA[ผลการปฏิบัติงาน (ค่าปรับ)]]></text>
				</staticText>
				<line>
					<reportElement x="495" y="52" width="1" height="71"/>
				</line>
				<line>
					<reportElement x="549" y="52" width="1" height="71"/>
				</line>
				<line>
					<reportElement x="599" y="52" width="1" height="71"/>
				</line>
				<staticText>
					<reportElement x="433" y="52" width="71" height="71"/>
					<textElement textAlignment="Center" verticalAlignment="Middle">
						<font fontName="AngsanaUPC" size="14" pdfFontName="ANGSA.TTF" pdfEncoding="Identity-H" isPdfEmbedded="true"/>
					</textElement>
					<text><![CDATA[(6)
เปรียบเทียบ
ปรับ]]></text>
				</staticText>
				<staticText>
					<reportElement x="478" y="52" width="90" height="71"/>
					<textElement textAlignment="Center" verticalAlignment="Middle">
						<font fontName="AngsanaUPC" size="14" pdfFontName="ANGSA.TTF" pdfEncoding="Identity-H" isPdfEmbedded="true"/>
					</textElement>
					<text><![CDATA[(7)
ประมาณ
ค่าปรับ
(คดีฟ้องศาล)]]></text>
				</staticText>
				<staticText>
					<reportElement x="536" y="52" width="76" height="71"/>
					<textElement textAlignment="Center" verticalAlignment="Middle">
						<font fontName="AngsanaUPC" size="14" pdfFontName="ANGSA.TTF" pdfEncoding="Identity-H" isPdfEmbedded="true"/>
					</textElement>
					<text><![CDATA[(8)
ประมาณ
ค่าปรับ
(คดีไม่มีตัว)]]></text>
				</staticText>
				<staticText>
					<reportElement x="591" y="52" width="69" height="71"/>
					<textElement textAlignment="Center" verticalAlignment="Middle">
						<font fontName="AngsanaUPC" size="14" pdfFontName="ANGSA.TTF" pdfEncoding="Identity-H" isPdfEmbedded="true"/>
					</textElement>
					<text><![CDATA[(9)
รวมค่า
ปรับ
(6)+(7)+(8)]]></text>
				</staticText>
				<staticText>
					<reportElement x="628" y="0" width="101" height="122"/>
					<textElement textAlignment="Center" verticalAlignment="Middle">
						<font fontName="AngsanaUPC" size="14" pdfFontName="ANGSA.TTF" pdfEncoding="Identity-H" isPdfEmbedded="true"/>
					</textElement>
					<text><![CDATA[(10)
เป้าหมาย
ค่า
เปรียบเทียบ
ปรับ]]></text>
				</staticText>
				<line>
					<reportElement x="757" y="0" width="1" height="123"/>
				</line>
				<staticText>
					<reportElement x="692" y="0" width="73" height="123"/>
					<textElement textAlignment="Center" verticalAlignment="Middle">
						<font fontName="AngsanaUPC" size="14" pdfFontName="ANGSA.TTF" pdfEncoding="Identity-H" isPdfEmbedded="true"/>
					</textElement>
					<text><![CDATA[ผลต่าง
(6) กับ
(10)
 +สูง - ต่ำ]]></text>
				</staticText>
				<staticText>
					<reportElement x="750" y="0" width="61" height="122"/>
					<textElement textAlignment="Center" verticalAlignment="Middle">
						<font fontName="AngsanaUPC" size="14" pdfFontName="ANGSA.TTF" pdfEncoding="Identity-H" isPdfEmbedded="true"/>
					</textElement>
					<text><![CDATA[คิด
เป็น %
+สูง - ต่ำ]]></text>
				</staticText>
				<line>
					<reportElement x="126" y="52" width="193" height="1"/>
				</line>
				<line>
					<reportElement x="444" y="52" width="207" height="1"/>
				</line>
				<line>
					<reportElement x="402" y="0" width="1" height="123"/>
				</line>
				<staticText>
					<reportElement x="391" y="0" width="64" height="123"/>
					<textElement textAlignment="Center" verticalAlignment="Middle">
						<font fontName="AngsanaUPC" size="14" pdfFontName="ANGSA.TTF" pdfEncoding="Identity-H" isPdfEmbedded="true"/>
					</textElement>
					<text><![CDATA[คิดเป็น
%
 +สูง - ต่ำ]]></text>
				</staticText>
			</band>
		</groupHeader>
		<groupFooter>
			<band/>
		</groupFooter>
	</group>
	<background>
		<band splitType="Stretch"/>
	</background>
	<title>
		<band height="91" splitType="Stretch">
			<staticText>
				<reportElement x="126" y="0" width="1271" height="28"/>
				<textElement verticalAlignment="Middle" markup="none">
					<font fontName="Angsana New" size="20" isBold="true" pdfFontName="ANGSA.TTF" pdfEncoding="Identity-H" isPdfEmbedded="true"/>
				</textElement>
				<text><![CDATA[รายงานการปราบปรามผู้กระทำผิดกฎหมายสรรพสามิต (รวมทุกพระราชบัญญัติ) (ข้อมูลโดยรวม)]]></text>
			</staticText>
			<staticText>
				<reportElement x="240" y="28" width="1207" height="28"/>
				<textElement verticalAlignment="Middle" markup="none">
					<font fontName="Angsana New" size="20" isBold="true" pdfFontName="ANGSA.TTF" pdfEncoding="Identity-H" isPdfEmbedded="true"/>
				</textElement>
				<text><![CDATA[รวมส่วนกลางและส่วนภูมิภาคจำแนกตามเขตพื้นที่]]></text>
			</staticText>
			<staticText>
				<reportElement x="240" y="56" width="1000" height="28"/>
				<textElement verticalAlignment="Middle" markup="none">
					<font fontName="Angsana New" size="20" isBold="true" pdfFontName="ANGSA.TTF" pdfEncoding="Identity-H" isPdfEmbedded="true"/>
				</textElement>
				<text><![CDATA[ปีงบประมาณ .................... เดือน ...........................]]></text>
			</staticText>
			<staticText>
				<reportElement x="710" y="66" width="1000" height="25"/>
				<textElement verticalAlignment="Middle">
					<font fontName="AngsanaUPC" size="14" pdfFontName="ANGSA.TTF" pdfEncoding="Identity-H" isPdfEmbedded="true"/>
				</textElement>
				<text><![CDATA[             หน่วย : ราย,บาท]]></text>
			</staticText>
			<textField>
				<reportElement x="326" y="55" width="100" height="28"/>
				<textElement>
					<font fontName="Angsana New" size="20" isBold="true" pdfFontName="ANGSA.TTF" pdfEncoding="Identity-H" isPdfEmbedded="true"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[$P{getYear1}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="424" y="55" width="166" height="28"/>
				<textElement>
					<font fontName="Angsana New" size="20" isBold="true" pdfFontName="ANGSA.TTF" pdfEncoding="Identity-H" isPdfEmbedded="true"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[$F{MONTH_NAME}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="26" y="-20" width="1101" height="20"/>
				<textElement>
					<font fontName="Angsana New" size="14" pdfFontName="ANGSA.TTF" pdfEncoding="Identity-H" isPdfEmbedded="true"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[$F{UNTILDATE}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="110" y="-20" width="911" height="20"/>
				<textElement>
					<font fontName="Angsana New" size="14" pdfFontName="ANGSA.TTF" pdfEncoding="Identity-H"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[$F{SYSTIMEDATE}]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement x="688" y="-20" width="919" height="20"/>
				<textElement>
					<font fontName="Angsana New" size="14" pdfFontName="ANGSA.TTF" pdfEncoding="Identity-H" isPdfEmbedded="true"/>
				</textElement>
				<text><![CDATA[Report ID: 1.14 (ILLR8114)]]></text>
			</staticText>
			<staticText>
				<reportElement x="0" y="-20" width="500" height="20"/>
				<textElement>
					<font fontName="Angsana New" size="14" pdfFontName="ANGSA.TTF" pdfEncoding="Identity-H" isPdfEmbedded="true"/>
				</textElement>
				<text><![CDATA[วันที่ :]]></text>
			</staticText>
		</band>
	</title>
	<detail>
		<band height="19" splitType="Stretch">
			<rectangle>
				<reportElement x="0" y="0" width="802" height="19"/>
			</rectangle>
			<line>
				<reportElement x="125" y="0" width="1" height="19"/>
			</line>
			<line>
				<reportElement x="174" y="0" width="1" height="19"/>
			</line>
			<line>
				<reportElement x="222" y="0" width="1" height="19"/>
			</line>
			<line>
				<reportElement x="269" y="0" width="1" height="19"/>
			</line>
			<line>
				<reportElement x="319" y="0" width="1" height="19"/>
			</line>
			<line>
				<reportElement x="360" y="0" width="1" height="19"/>
			</line>
			<line>
				<reportElement x="443" y="0" width="1" height="19"/>
			</line>
			<line>
				<reportElement x="495" y="0" width="1" height="19"/>
			</line>
			<line>
				<reportElement x="549" y="0" width="1" height="19"/>
			</line>
			<line>
				<reportElement x="599" y="0" width="1" height="19"/>
			</line>
			<line>
				<reportElement x="652" y="0" width="1" height="19"/>
			</line>
			<line>
				<reportElement x="704" y="0" width="1" height="19"/>
			</line>
			<line>
				<reportElement x="757" y="0" width="1" height="19"/>
			</line>
			<textField>
				<reportElement x="2" y="0" width="228" height="19"/>
				<textElement verticalAlignment="Middle">
					<font fontName="Angsana New" size="12" pdfFontName="ANGSA.TTF" pdfEncoding="Identity-H" isPdfEmbedded="true"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[$F{SHORT_NAME}]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0" isBlankWhenNull="true">
				<reportElement x="115" y="0" width="58" height="19"/>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font fontName="Angsana New" size="12" pdfFontName="ANGSA.TTF" pdfEncoding="Identity-H" isPdfEmbedded="true"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[com.ko.util.NumberUtil.getNumberFormat($F{COMPARE_CASE_QTY}.doubleValue(),0, "")]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0" isBlankWhenNull="true">
				<reportElement x="147" y="0" width="75" height="19"/>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font fontName="Angsana New" size="12" pdfFontName="ANGSA.TTF" pdfEncoding="Identity-H" isPdfEmbedded="true"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[com.ko.util.NumberUtil.getNumberFormat($F{SENDCOURT_QTY}.doubleValue(),0, "")]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0.00" isBlankWhenNull="true">
				<reportElement x="201" y="0" width="67" height="19"/>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font fontName="Angsana New" size="12" pdfFontName="ANGSA.TTF" pdfEncoding="Identity-H" isPdfEmbedded="true"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[com.ko.util.NumberUtil.getNumberFormat($F{NO_CULPRIT_QTY}.doubleValue(),0, "")]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0" isBlankWhenNull="true">
				<reportElement x="246" y="0" width="71" height="19"/>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font fontName="Angsana New" size="12" pdfFontName="ANGSA.TTF" pdfEncoding="Identity-H" isPdfEmbedded="true"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[com.ko.util.NumberUtil.getNumberFormat($F{TOTAL_CASE_QTY}.doubleValue(),0, "")]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0" isBlankWhenNull="true">
				<reportElement x="295" y="0" width="64" height="19"/>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font fontName="Angsana New" size="12" pdfFontName="ANGSA.TTF" pdfEncoding="Identity-H" isPdfEmbedded="true"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[com.ko.util.NumberUtil.getNumberFormat($F{TARGET_QTY}.doubleValue(),0, "")]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0" isBlankWhenNull="true">
				<reportElement x="332" y="0" width="70" height="19"/>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font fontName="Angsana New" size="12" pdfFontName="ANGSA.TTF" pdfEncoding="Identity-H" isPdfEmbedded="true"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[com.ko.util.NumberUtil.getNumberFormat($F{DIFF_CASE_QTY}.doubleValue(),0, "")]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0.00" isBlankWhenNull="true">
				<reportElement x="413" y="0" width="81" height="19"/>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font fontName="Angsana New" size="12" pdfFontName="ANGSA.TTF" pdfEncoding="Identity-H" isPdfEmbedded="true"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[com.ko.util.NumberUtil.getNumberFormat($F{COMPARE_FINE}.doubleValue(),2, "")]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0.00" isBlankWhenNull="true">
				<reportElement x="459" y="0" width="89" height="19"/>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font fontName="Angsana New" size="12" pdfFontName="ANGSA.TTF" pdfEncoding="Identity-H" isPdfEmbedded="true"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[com.ko.util.NumberUtil.getNumberFormat($F{SENDCOURT_FINE}.doubleValue(),2, "")]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0.00" isBlankWhenNull="true">
				<reportElement x="518" y="0" width="80" height="19"/>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font fontName="Angsana New" size="12" pdfFontName="ANGSA.TTF" pdfEncoding="Identity-H" isPdfEmbedded="true"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[com.ko.util.NumberUtil.getNumberFormat($F{NO_CULPRIT_FINE}.doubleValue(),2, "")]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0.00" isBlankWhenNull="true">
				<reportElement x="564" y="0" width="87" height="19"/>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font fontName="Angsana New" size="12" pdfFontName="ANGSA.TTF" pdfEncoding="Identity-H" isPdfEmbedded="true"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[com.ko.util.NumberUtil.getNumberFormat($F{TOTAL_SUM_FINE}.doubleValue(),2, "")]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0.00" isBlankWhenNull="true">
				<reportElement x="622" y="0" width="81" height="19"/>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font fontName="Angsana New" size="12" pdfFontName="ANGSA.TTF" pdfEncoding="Identity-H" isPdfEmbedded="true"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[com.ko.util.NumberUtil.getNumberFormat($F{TARGET_FINE}.doubleValue(),2, "")]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0.00" isBlankWhenNull="true">
				<reportElement x="705" y="0" width="96" height="19"/>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font fontName="Angsana New" size="12" pdfFontName="ANGSA.TTF" pdfEncoding="Identity-H" isPdfEmbedded="true"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[com.ko.util.NumberUtil.getNumberFormat($F{DIFF_FINE_PERCENT}.doubleValue(),0, "")]]></textFieldExpression>
			</textField>
			<textField pattern="#,##0.00" isBlankWhenNull="true">
				<reportElement x="664" y="0" width="93" height="19"/>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font fontName="Angsana New" size="12" pdfFontName="ANGSA.TTF" pdfEncoding="Identity-H" isPdfEmbedded="true"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[com.ko.util.NumberUtil.getNumberFormat($F{DIFF_FINE}.doubleValue(),2, "")]]></textFieldExpression>
			</textField>
			<line>
				<reportElement x="402" y="0" width="1" height="19"/>
			</line>
			<textField isBlankWhenNull="true">
				<reportElement x="342" y="0" width="100" height="19"/>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font fontName="Angsana New" size="12" pdfFontName="ANGSA.TTF" pdfEncoding="Identity-H"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[com.ko.util.NumberUtil.getNumberFormat((($F{DIFF_CASE_QTY}.doubleValue()*100)/$F{TOTAL_CASE_QTY}.doubleValue()).doubleValue(),2, "")]]></textFieldExpression>
			</textField>
		</band>
	</detail>
	<pageFooter>
		<band height="20">
			<staticText>
				<reportElement x="0" y="0" width="500" height="20"/>
				<textElement verticalAlignment="Middle">
					<font fontName="Angsana New" size="14" pdfFontName="ANGSA.TTF" pdfEncoding="Identity-H" isPdfEmbedded="true"/>
				</textElement>
				<text><![CDATA[User :]]></text>
			</staticText>
			<textField>
				<reportElement x="789" y="0" width="1000" height="20"/>
				<textElement verticalAlignment="Middle">
					<font fontName="Angsana New" size="14" pdfFontName="ANGSA.TTF" pdfEncoding="Identity-H" isPdfEmbedded="true"/>
				</textElement>
				<textFieldExpression class="java.lang.Integer"><![CDATA[$V{PAGE_NUMBER}]]></textFieldExpression>
			</textField>
			<textField>
				<reportElement x="39" y="0" width="660" height="20"/>
				<textElement verticalAlignment="Middle">
					<font fontName="Angsana New" size="14" pdfFontName="ANGSA.TTF" pdfEncoding="Identity-H" isPdfEmbedded="true"/>
				</textElement>
				<textFieldExpression class="java.lang.String"><![CDATA[$F{USER_NAME}]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement x="763" y="0" width="500" height="20"/>
				<textElement verticalAlignment="Middle">
					<font fontName="Angsana New" size="14" pdfFontName="ANGSA.TTF" pdfEncoding="Identity-H" isPdfEmbedded="true"/>
				</textElement>
				<text><![CDATA[Page :]]></text>
			</staticText>
		</band>
	</pageFooter>
</jasperReport>
